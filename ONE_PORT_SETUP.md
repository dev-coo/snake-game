# 🚀 단일 포트(3000)로 게임 호스팅하기

3001 포트를 포트포워딩하지 않고, 3000 포트만으로 클라이언트와 서버를 모두 운영하는 방법입니다.

## 작동 원리

```
외부 사용자 → [공인IP:3000] → Vite Dev Server → Proxy → [localhost:3001] 서버
                                     ↓
                              React 앱 제공
```

Vite의 프록시 기능을 사용하여:
- `/socket.io/*` 요청은 → localhost:3001로 전달
- `/api/*` 요청은 → localhost:3001로 전달
- 나머지 요청은 → React 앱 제공

## 설정 방법

### 1. 포트포워딩
- **3000번 포트만** 포트포워딩 설정
- 3001번 포트는 포트포워딩 불필요

### 2. 서버 실행
```bash
npm run dev
```

### 3. 접속 방법

**로컬 (호스트 컴퓨터):**
```
http://localhost:3000
```

**외부 네트워크:**
```
http://[공인IP]:3000
```

## 장점
- 단일 포트만 개방하면 됨 (보안상 유리)
- 복잡한 네트워크 설정 불필요
- CORS 문제 자동 해결

## 주의사항
- 개발 서버(Vite)를 통한 프록시이므로 프로덕션에서는 Nginx 등으로 대체 필요
- 서버와 클라이언트가 같은 머신에서 실행되어야 함

## 디버깅

브라우저 콘솔(F12)에서 확인:
```javascript
// 연결 URL 확인
console.log(window.location.href)
// "Using proxy through: http://[공인IP]:3000" 메시지 확인
```

네트워크 탭에서:
- `/socket.io` 요청이 200 OK 응답하는지 확인
- WebSocket 연결이 101 Switching Protocols로 업그레이드되는지 확인

## 문제 해결

**"서버에 연결할 수 없습니다" 에러:**
1. 서버가 실행 중인지 확인 (`npm run dev`)
2. 3000 포트 포트포워딩 확인
3. 방화벽에서 Node.js 허용 확인

**WebSocket 연결 실패:**
1. 브라우저 캐시 삭제 (Ctrl+Shift+Delete)
2. 시크릿 모드에서 테스트
3. 다른 브라우저에서 테스트